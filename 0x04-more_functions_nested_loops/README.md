More functions ad nested loops
